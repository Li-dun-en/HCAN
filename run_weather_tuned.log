nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', batch_size=32, beta_scale=1.0, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp_Weather_Tuned', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=5, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, lambda_acl=1.0, lambda_cls=0.1, lambda_direct=1.0, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96_96_Hybrid_Tuning', n_heads=8, num_coarse=2, num_fine=4, num_workers=10, output_attention=False, patience=4, pred_len=96, root_path='./dataset/weather', seq_len=96, target='OT', test_flop=False, train_epochs=12, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_Hybrid_Tuning_Informer_custom_ftM_sl96_ll48_pl96_nc2_nf4_beta1.0_wcls0.1_wacl1.0_Exp_Weather_Tuned_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696 M
val 5175 M
test 10444 M
[Exp] Loading Centers from Dataset...
[Exp] Coarse Centers: [-0.43889704  1.2127079 ]
[Exp] Fine Centers: [-0.92581934 -0.04671306  0.9525164   2.2943478 ]
	iters: 100, epoch: 1 | loss: 1.4160441 | mse: 1.3706, uac: 0.4505, hcl: 0.0004
	speed: 0.0560s/iter; left time: 765.1119s
	iters: 200, epoch: 1 | loss: 0.4379587 | mse: 0.3922, uac: 0.4550, hcl: 0.0002
	speed: 0.0452s/iter; left time: 612.7274s
	iters: 300, epoch: 1 | loss: 0.4142760 | mse: 0.3715, uac: 0.4262, hcl: 0.0002
	speed: 0.0466s/iter; left time: 627.5262s
	iters: 400, epoch: 1 | loss: 0.3174124 | mse: 0.2742, uac: 0.4312, hcl: 0.0001
	speed: 0.0451s/iter; left time: 602.0754s
	iters: 500, epoch: 1 | loss: 0.4102309 | mse: 0.3666, uac: 0.4354, hcl: 0.0001
	speed: 0.0479s/iter; left time: 635.1675s
	iters: 600, epoch: 1 | loss: 1.3295938 | mse: 1.2891, uac: 0.4034, hcl: 0.0001
	speed: 0.0521s/iter; left time: 685.0111s
	iters: 700, epoch: 1 | loss: 0.4501710 | mse: 0.4110, uac: 0.3909, hcl: 0.0001
	speed: 0.0583s/iter; left time: 761.0504s
	iters: 800, epoch: 1 | loss: 0.4528281 | mse: 0.4111, uac: 0.4161, hcl: 0.0001
	speed: 0.0591s/iter; left time: 765.9128s
	iters: 900, epoch: 1 | loss: 0.2913033 | mse: 0.2520, uac: 0.3925, hcl: 0.0001
	speed: 0.0596s/iter; left time: 765.9866s
	iters: 1000, epoch: 1 | loss: 0.2734002 | mse: 0.2360, uac: 0.3733, hcl: 0.0001
	speed: 0.0524s/iter; left time: 668.6882s
	iters: 1100, epoch: 1 | loss: 0.3419380 | mse: 0.3031, uac: 0.3876, hcl: 0.0001
	speed: 0.0520s/iter; left time: 658.2079s
Epoch: 1 | 12 cost time: 60.3600s
Epoch: 1, Steps: 1146 | Train Loss: 0.4414557 Vali Loss: 0.5532916 Test Loss: 0.3922708
Validation loss decreased (inf --> 0.553292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5507606 | mse: 0.5116, uac: 0.3914, hcl: 0.0001
	speed: 0.1877s/iter; left time: 2347.8434s
	iters: 200, epoch: 2 | loss: 0.2547607 | mse: 0.2182, uac: 0.3646, hcl: 0.0000
	speed: 0.0524s/iter; left time: 650.5405s
	iters: 300, epoch: 2 | loss: 0.2998725 | mse: 0.2655, uac: 0.3428, hcl: 0.0000
	speed: 0.0642s/iter; left time: 789.7667s
	iters: 400, epoch: 2 | loss: 0.2549722 | mse: 0.2214, uac: 0.3357, hcl: 0.0000
	speed: 0.0605s/iter; left time: 739.0725s
	iters: 500, epoch: 2 | loss: 0.2324346 | mse: 0.2001, uac: 0.3228, hcl: 0.0000
	speed: 0.0612s/iter; left time: 741.2698s
	iters: 600, epoch: 2 | loss: 0.4007102 | mse: 0.3677, uac: 0.3295, hcl: 0.0000
	speed: 0.0554s/iter; left time: 664.6848s
	iters: 700, epoch: 2 | loss: 0.2696147 | mse: 0.2380, uac: 0.3162, hcl: 0.0000
	speed: 0.0463s/iter; left time: 550.7735s
	iters: 800, epoch: 2 | loss: 0.4248370 | mse: 0.3918, uac: 0.3297, hcl: 0.0000
	speed: 0.0624s/iter; left time: 736.5018s
	iters: 900, epoch: 2 | loss: 0.2089771 | mse: 0.1761, uac: 0.3280, hcl: 0.0000
	speed: 0.0570s/iter; left time: 666.9223s
	iters: 1000, epoch: 2 | loss: 1.1188207 | mse: 1.0874, uac: 0.3139, hcl: 0.0000
	speed: 0.0552s/iter; left time: 640.4956s
	iters: 1100, epoch: 2 | loss: 0.2478969 | mse: 0.2171, uac: 0.3079, hcl: 0.0000
	speed: 0.0597s/iter; left time: 687.3591s
Epoch: 2 | 12 cost time: 66.5449s
Epoch: 2, Steps: 1146 | Train Loss: 0.3587643 Vali Loss: 0.5528325 Test Loss: 0.3216447
Validation loss decreased (0.553292 --> 0.552832).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1979190 | mse: 0.1682, uac: 0.2972, hcl: 0.0000
	speed: 0.1869s/iter; left time: 2123.8434s
	iters: 200, epoch: 3 | loss: 0.4463419 | mse: 0.4122, uac: 0.3410, hcl: 0.0000
	speed: 0.0535s/iter; left time: 602.8234s
	iters: 300, epoch: 3 | loss: 0.2322970 | mse: 0.2020, uac: 0.3029, hcl: 0.0000
	speed: 0.0480s/iter; left time: 535.4200s
	iters: 400, epoch: 3 | loss: 0.2160925 | mse: 0.1847, uac: 0.3135, hcl: 0.0000
	speed: 0.0533s/iter; left time: 589.7843s
	iters: 500, epoch: 3 | loss: 0.1760457 | mse: 0.1472, uac: 0.2886, hcl: 0.0000
	speed: 0.0556s/iter; left time: 609.2401s
	iters: 600, epoch: 3 | loss: 0.2466036 | mse: 0.2164, uac: 0.3018, hcl: 0.0000
	speed: 0.0604s/iter; left time: 655.9929s
	iters: 700, epoch: 3 | loss: 0.2616552 | mse: 0.2307, uac: 0.3090, hcl: 0.0000
	speed: 0.0543s/iter; left time: 584.5329s
	iters: 800, epoch: 3 | loss: 0.2961099 | mse: 0.2654, uac: 0.3067, hcl: 0.0000
	speed: 0.0557s/iter; left time: 594.2155s
	iters: 900, epoch: 3 | loss: 0.2645617 | mse: 0.2350, uac: 0.2953, hcl: 0.0000
	speed: 0.0509s/iter; left time: 537.1518s
	iters: 1000, epoch: 3 | loss: 0.1888540 | mse: 0.1606, uac: 0.2824, hcl: 0.0000
	speed: 0.0577s/iter; left time: 603.8996s
	iters: 1100, epoch: 3 | loss: 0.4003187 | mse: 0.3717, uac: 0.2859, hcl: 0.0000
	speed: 0.0566s/iter; left time: 586.4731s
Epoch: 3 | 12 cost time: 63.5758s
Epoch: 3, Steps: 1146 | Train Loss: 0.3012225 Vali Loss: 0.5613534 Test Loss: 0.4053276
EarlyStopping counter: 1 out of 4
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2843382 | mse: 0.2536, uac: 0.3070, hcl: 0.0000
	speed: 0.1839s/iter; left time: 1878.6936s
	iters: 200, epoch: 4 | loss: 0.2284806 | mse: 0.2016, uac: 0.2687, hcl: 0.0000
	speed: 0.0560s/iter; left time: 566.7967s
	iters: 300, epoch: 4 | loss: 0.2007678 | mse: 0.1727, uac: 0.2802, hcl: 0.0000
	speed: 0.0510s/iter; left time: 510.2765s
	iters: 400, epoch: 4 | loss: 0.8848795 | mse: 0.8568, uac: 0.2806, hcl: 0.0000
	speed: 0.0489s/iter; left time: 484.6061s
	iters: 500, epoch: 4 | loss: 0.1908015 | mse: 0.1611, uac: 0.2968, hcl: 0.0000
	speed: 0.0539s/iter; left time: 528.9759s
	iters: 600, epoch: 4 | loss: 0.9166297 | mse: 0.8869, uac: 0.2970, hcl: 0.0000
	speed: 0.0583s/iter; left time: 566.7435s
	iters: 700, epoch: 4 | loss: 0.2306036 | mse: 0.2043, uac: 0.2624, hcl: 0.0000
	speed: 0.0530s/iter; left time: 509.4845s
	iters: 800, epoch: 4 | loss: 0.1564138 | mse: 0.1277, uac: 0.2871, hcl: 0.0000
	speed: 0.0514s/iter; left time: 488.8386s
	iters: 900, epoch: 4 | loss: 0.8936128 | mse: 0.8653, uac: 0.2825, hcl: 0.0000
	speed: 0.0478s/iter; left time: 449.7302s
	iters: 1000, epoch: 4 | loss: 0.1484416 | mse: 0.1210, uac: 0.2746, hcl: 0.0000
	speed: 0.0476s/iter; left time: 443.7538s
	iters: 1100, epoch: 4 | loss: 0.2066816 | mse: 0.1784, uac: 0.2823, hcl: 0.0000
	speed: 0.0475s/iter; left time: 438.0681s
Epoch: 4 | 12 cost time: 60.2102s
Epoch: 4, Steps: 1146 | Train Loss: 0.2744471 Vali Loss: 0.5524058 Test Loss: 0.4128689
Validation loss decreased (0.552832 --> 0.552406).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1485749 | mse: 0.1196, uac: 0.2896, hcl: 0.0000
	speed: 0.1863s/iter; left time: 1689.9832s
	iters: 200, epoch: 5 | loss: 0.1818601 | mse: 0.1539, uac: 0.2797, hcl: 0.0000
	speed: 0.0397s/iter; left time: 355.7678s
	iters: 300, epoch: 5 | loss: 0.1533902 | mse: 0.1268, uac: 0.2660, hcl: 0.0000
	speed: 0.0509s/iter; left time: 451.1747s
	iters: 400, epoch: 5 | loss: 0.1870432 | mse: 0.1594, uac: 0.2766, hcl: 0.0000
	speed: 0.0610s/iter; left time: 535.1132s
	iters: 500, epoch: 5 | loss: 0.2048310 | mse: 0.1766, uac: 0.2818, hcl: 0.0000
	speed: 0.0473s/iter; left time: 410.2435s
	iters: 600, epoch: 5 | loss: 0.2366813 | mse: 0.2077, uac: 0.2897, hcl: 0.0000
	speed: 0.0519s/iter; left time: 444.7633s
	iters: 700, epoch: 5 | loss: 0.1673447 | mse: 0.1377, uac: 0.2963, hcl: 0.0000
	speed: 0.0509s/iter; left time: 431.1259s
	iters: 800, epoch: 5 | loss: 0.1892250 | mse: 0.1590, uac: 0.3024, hcl: 0.0000
	speed: 0.0467s/iter; left time: 390.7383s
	iters: 900, epoch: 5 | loss: 0.1372751 | mse: 0.1103, uac: 0.2690, hcl: 0.0000
	speed: 0.0482s/iter; left time: 398.1987s
	iters: 1000, epoch: 5 | loss: 0.1602145 | mse: 0.1326, uac: 0.2762, hcl: 0.0000
	speed: 0.0580s/iter; left time: 473.4960s
	iters: 1100, epoch: 5 | loss: 0.2273434 | mse: 0.1994, uac: 0.2791, hcl: 0.0000
	speed: 0.0475s/iter; left time: 383.5609s
Epoch: 5 | 12 cost time: 58.9126s
Epoch: 5, Steps: 1146 | Train Loss: 0.2617906 Vali Loss: 0.5587009 Test Loss: 0.4230041
EarlyStopping counter: 1 out of 4
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1684755 | mse: 0.1414, uac: 0.2703, hcl: 0.0000
	speed: 0.1916s/iter; left time: 1518.0798s
	iters: 200, epoch: 6 | loss: 0.1852596 | mse: 0.1569, uac: 0.2833, hcl: 0.0000
	speed: 0.0510s/iter; left time: 398.7231s
	iters: 300, epoch: 6 | loss: 0.1163933 | mse: 0.0900, uac: 0.2636, hcl: 0.0000
	speed: 0.0485s/iter; left time: 374.6709s
	iters: 400, epoch: 6 | loss: 0.1834757 | mse: 0.1542, uac: 0.2925, hcl: 0.0000
	speed: 0.0405s/iter; left time: 309.0657s
	iters: 500, epoch: 6 | loss: 0.1992785 | mse: 0.1729, uac: 0.2636, hcl: 0.0000
	speed: 0.0496s/iter; left time: 373.2168s
	iters: 600, epoch: 6 | loss: 0.1433910 | mse: 0.1144, uac: 0.2899, hcl: 0.0000
	speed: 0.0497s/iter; left time: 369.1960s
	iters: 700, epoch: 6 | loss: 0.7457008 | mse: 0.7164, uac: 0.2923, hcl: 0.0000
	speed: 0.0573s/iter; left time: 419.9476s
	iters: 800, epoch: 6 | loss: 0.1577869 | mse: 0.1304, uac: 0.2738, hcl: 0.0000
	speed: 0.0458s/iter; left time: 330.7968s
	iters: 900, epoch: 6 | loss: 0.1847111 | mse: 0.1574, uac: 0.2725, hcl: 0.0000
	speed: 0.0571s/iter; left time: 406.5172s
	iters: 1000, epoch: 6 | loss: 0.2822219 | mse: 0.2536, uac: 0.2854, hcl: 0.0000
	speed: 0.0564s/iter; left time: 395.8917s
	iters: 1100, epoch: 6 | loss: 0.1777248 | mse: 0.1513, uac: 0.2643, hcl: 0.0000
	speed: 0.0566s/iter; left time: 392.0345s
Epoch: 6 | 12 cost time: 60.8911s
Epoch: 6, Steps: 1146 | Train Loss: 0.2555827 Vali Loss: 0.5544271 Test Loss: 0.4195797
EarlyStopping counter: 2 out of 4
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3376459 | mse: 0.3100, uac: 0.2763, hcl: 0.0000
	speed: 0.1938s/iter; left time: 1313.3992s
	iters: 200, epoch: 7 | loss: 0.2764506 | mse: 0.2491, uac: 0.2729, hcl: 0.0000
	speed: 0.0511s/iter; left time: 341.5004s
	iters: 300, epoch: 7 | loss: 0.2423559 | mse: 0.2160, uac: 0.2634, hcl: 0.0000
	speed: 0.0602s/iter; left time: 395.6197s
	iters: 400, epoch: 7 | loss: 0.7812731 | mse: 0.7552, uac: 0.2602, hcl: 0.0000
	speed: 0.0563s/iter; left time: 364.3480s
	iters: 500, epoch: 7 | loss: 0.1784069 | mse: 0.1501, uac: 0.2823, hcl: 0.0000
	speed: 0.0466s/iter; left time: 296.8595s
	iters: 600, epoch: 7 | loss: 0.1923886 | mse: 0.1638, uac: 0.2857, hcl: 0.0000
	speed: 0.0608s/iter; left time: 381.9121s
	iters: 700, epoch: 7 | loss: 0.2606353 | mse: 0.2325, uac: 0.2813, hcl: 0.0000
	speed: 0.0545s/iter; left time: 336.9132s
	iters: 800, epoch: 7 | loss: 0.1906127 | mse: 0.1631, uac: 0.2752, hcl: 0.0000
	speed: 0.0449s/iter; left time: 272.5842s
	iters: 900, epoch: 7 | loss: 0.2376016 | mse: 0.2100, uac: 0.2753, hcl: 0.0000
	speed: 0.0443s/iter; left time: 264.7992s
	iters: 1000, epoch: 7 | loss: 0.2384605 | mse: 0.2125, uac: 0.2590, hcl: 0.0000
	speed: 0.0513s/iter; left time: 301.3107s
	iters: 1100, epoch: 7 | loss: 0.1598987 | mse: 0.1334, uac: 0.2651, hcl: 0.0000
	speed: 0.0515s/iter; left time: 297.7073s
Epoch: 7 | 12 cost time: 61.7563s
Epoch: 7, Steps: 1146 | Train Loss: 0.2523785 Vali Loss: 0.5626333 Test Loss: 0.4313113
EarlyStopping counter: 3 out of 4
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1579889 | mse: 0.1319, uac: 0.2610, hcl: 0.0000
	speed: 0.1863s/iter; left time: 1048.9815s
	iters: 200, epoch: 8 | loss: 0.2426445 | mse: 0.2156, uac: 0.2701, hcl: 0.0000
	speed: 0.0503s/iter; left time: 278.3233s
	iters: 300, epoch: 8 | loss: 0.1597338 | mse: 0.1337, uac: 0.2597, hcl: 0.0000
	speed: 0.0517s/iter; left time: 280.7233s
	iters: 400, epoch: 8 | loss: 0.7626234 | mse: 0.7366, uac: 0.2599, hcl: 0.0000
	speed: 0.0515s/iter; left time: 274.7112s
	iters: 500, epoch: 8 | loss: 0.2387326 | mse: 0.2098, uac: 0.2886, hcl: 0.0000
	speed: 0.0534s/iter; left time: 279.4851s
	iters: 600, epoch: 8 | loss: 0.1855825 | mse: 0.1589, uac: 0.2662, hcl: 0.0000
	speed: 0.0479s/iter; left time: 245.5931s
	iters: 700, epoch: 8 | loss: 0.1761902 | mse: 0.1471, uac: 0.2903, hcl: 0.0000
	speed: 0.0530s/iter; left time: 266.4165s
	iters: 800, epoch: 8 | loss: 0.7577909 | mse: 0.7311, uac: 0.2663, hcl: 0.0000
	speed: 0.0569s/iter; left time: 280.3397s
	iters: 900, epoch: 8 | loss: 0.1370515 | mse: 0.1110, uac: 0.2598, hcl: 0.0000
	speed: 0.0571s/iter; left time: 275.6412s
	iters: 1000, epoch: 8 | loss: 0.1352106 | mse: 0.1087, uac: 0.2647, hcl: 0.0000
	speed: 0.0561s/iter; left time: 265.3238s
	iters: 1100, epoch: 8 | loss: 0.2553165 | mse: 0.2294, uac: 0.2584, hcl: 0.0000
	speed: 0.0490s/iter; left time: 227.0808s
Epoch: 8 | 12 cost time: 61.1407s
Epoch: 8, Steps: 1146 | Train Loss: 0.2505657 Vali Loss: 0.5592498 Test Loss: 0.4192605
EarlyStopping counter: 4 out of 4
Early stopping
>>>>>>>testing : weather_96_96_Hybrid_Tuning_Informer_custom_ftM_sl96_ll48_pl96_nc2_nf4_beta1.0_wcls0.1_wacl1.0_Exp_Weather_Tuned_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444 M
rmse:0.6273378729820251, mse:0.39355283975601196, mae:0.4395941197872162, corr:[0.45439667 0.45534137 0.45371658 0.45305645 0.45051172 0.45013082
 0.4415413  0.4373138  0.43811607 0.4323085  0.4388201  0.4418734
 0.44266105 0.44440678 0.44637293 0.43758917 0.43793178 0.44309384
 0.4428576  0.44286105 0.44267982 0.442419   0.4424074  0.442022
 0.42508474 0.42561245 0.42754    0.42899445 0.43014517 0.42576605
 0.42679816 0.42841095 0.4287341  0.42014802 0.4230144  0.4279238
 0.4273314  0.42569467 0.42384234 0.42340368 0.42182603 0.42122123
 0.41214842 0.4086502  0.40744516 0.40339538 0.40802443 0.4105485
 0.4117387  0.41291812 0.412203   0.40903023 0.4079976  0.40904662
 0.4080935  0.40700054 0.4052321  0.40422943 0.40330118 0.4020671
 0.3876535  0.3926424  0.38822317 0.38804057 0.39091536 0.39401346
 0.39097136 0.3915224  0.390387   0.38951018 0.38589644 0.3868553
 0.37183434 0.37202647 0.38153973 0.381642   0.37717837 0.37631238
 0.37820974 0.37697208 0.3777405  0.37755844 0.37497684 0.3760091
 0.37945482 0.37967506 0.37982363 0.37660396 0.37794352 0.37540206
 0.37574053 0.37393928 0.3716158  0.3705616  0.3670906  0.36403695]
